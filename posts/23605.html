<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="redis"><meta name="description" content="Python | Flask |  MySQL | Linux | Ubuntu"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>radis安装配置 | 文彦笔记</title><link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//favicon.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//css/matery.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//css/my.css"><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/jquery/jquery.min.js"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4337512190549598" crossorigin="anonymous"></script><meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="文彦笔记" type="application/atom+xml"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">文彦笔记</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fas fa-archive" style="zoom:.6"></i> <span>归档</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fas fa-address-book" style="zoom:.6"></i> <span>友情链接</span></a></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">文彦笔记</div><div class="logo-desc">Python | Flask | MySQL | Linux | Ubuntu</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/archives" class="waves-effect waves-light"><i class="fa-fw fas fa-archive"></i> 归档</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="/friends" class="waves-effect waves-light"><i class="fa-fw fas fa-address-book"></i> 友情链接</a></li><li><div class="divider"></div></li><li><a href="https://github.com/ningwenyan" class="waves-effect waves-light" target="_blank"><i class="fab fa-github-square fa-fw"></i>Fork Me</a></li></ul></div></div><style>.nav-transparent .github-corner{display:none!important}.github-corner{position:absolute;z-index:10;top:0;right:0;border:0;transform:scale(1.1)}.github-corner svg{color:#0f9d58;fill:#fff;height:64px;width:64px}.github-corner:hover .octo-arm{animation:a .56s ease-in-out}.github-corner .octo-arm{animation:none}@keyframes a{0%,to{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}</style><a href="https://github.com/ningwenyan" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a></nav></header><div class="bg-cover pd-header post-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/ningwenyan/My_chat_picgo/2020-9-27/1601218579668-10303.png)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">radis安装配置</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/redis/"><span class="chip bg-color">redis</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/redis/" class="post-category">redis</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2020-09-27</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><p><img src="https://cdn.jsdelivr.net/gh/ningwenyan/My_chat_picgo/2020-9-27/1601218579668-10303.png" alt="10303"></p><h2 id="redis-安装配置"><a href="#redis-安装配置" class="headerlink" title="redis 安装配置"></a><code>redis</code> 安装配置</h2><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h3><blockquote><p>是一个高性能的 <code>key-value</code>数据库</p></blockquote><h3 id="2-安装配置"><a href="#2-安装配置" class="headerlink" title="2.安装配置"></a>2.安装配置</h3><blockquote><p>使用官网的<a href="https://redis.io/download" target="_blank" rel="noopener">安装</a></p><pre class="line-numbers language-shell"><code class="language-shell">$ wget http://download.redis.io/releases/redis-5.0.7.tar.gz
$ tar xzf redis-5.0.7.tar.gz
$ cd redis-5.0.7
$ make<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>运行完毕后,会生成一个新的<code>src</code> 文件目录,里面存放了所有的<code>redis</code> 的相关工具和配置文件.</p><p>可以直接运行<code>redis</code> 服务器</p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost src]# ./redis-server 
port 6379
pid 67606<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>可以看到,直接运行是前台运行,默认端口是<code>6379</code> ,一般来说,我们都是运行在后台的,可以编辑它的配置文件<code>redis.conf</code> 配置.这个文件位于<code>redis-5.0.7</code> 中.</p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost src]# cp ../redis.conf ./
[root@localhost src]# vim redis.conf 
# 编辑如下选项,启动后台守护进程
daemonize yes
[root@localhost src]# ./redis-server redis.conf
[root@localhost src]# ps -aux | grep redis
root      67749  0.2  0.1 153848  2340 ?         ./redis-server 127.0.0.1:6379
root      67762  0.0  0.0 112676   984 pts/0   grep --color=auto redis<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="3-redis-conf"><a href="#3-redis-conf" class="headerlink" title="3.redis.conf"></a>3.<code>redis.conf</code></h3><blockquote><p>配置文件详解</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># redis.conf</span>
<span class="token comment" spellcheck="true"># redis服务器加载配置文件运行类似于</span>
<span class="token comment" spellcheck="true"># ./redis-server /path/to/redis.conf</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 配置文件中需要设置内存大小时,可以使用1k,5GB,4M 等数据格式,转化如下</span>
<span class="token comment" spellcheck="true"># 1k => 1000 bytes</span>
<span class="token comment" spellcheck="true"># 1kb => 1024 bytes</span>
<span class="token comment" spellcheck="true"># 1m => 1000000 bytes</span>
<span class="token comment" spellcheck="true"># 1mb => 1024*1024 bytes</span>
<span class="token comment" spellcheck="true"># 1g => 1000000000 bytes</span>
<span class="token comment" spellcheck="true"># 1gb => 1024*1024*1024 bytes</span>
<span class="token comment" spellcheck="true"># 不区分大小写</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 指定reids 只接受来自该ip地址的请求,如果不设置,就处理所有的请求.</span>
<span class="token comment" spellcheck="true"># 在生产环境中最好设置这项</span>
<span class="token comment" spellcheck="true"># 可以绑定多个ip地址</span>
<span class="token comment" spellcheck="true"># bind 192.168.0.1 192.168.0.2</span>
<span class="token comment" spellcheck="true"># bind 127.0.0.1</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 指定redis 运行的端口</span>
prot <span class="token number">6379</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># daemonize no 默认情况下,redis不是后台运行的,如果要后台运行,要设置成yes</span>
daemonize yes
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 是否开启保护,默认是yes</span>
<span class="token comment" spellcheck="true"># 如果配置中没有指定bind和密码,开启这个参数,radis只会本地进行访问,拒绝外部访问</span>
protected<span class="token operator">-</span>mode yes
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 配置unix socket来让redis支持监听本地连接。</span>
unixsocket <span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>redis<span class="token operator">/</span>redis<span class="token punctuation">.</span>sock
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 配置unix socket使用文件的权限</span>
unixsocketperm <span class="token number">700</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 当redis运行的时候,redis默认把pid 文件放在/var/run/redis.pid可以配置到其他地址</span>
<span class="token comment" spellcheck="true"># 当运行多个redis服务器时,需要指定不同的pid文件和端口</span>
pidfile <span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>redis_6379<span class="token punctuation">.</span>pid
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 设置客户端的连接超时时间,单位为秒.</span>
<span class="token comment" spellcheck="true"># 0 为关闭该设置</span>
timeout <span class="token number">0</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 指定日志级别</span>
<span class="token comment" spellcheck="true"># redis 支持和4个级别,</span>
<span class="token comment" spellcheck="true"># debug 记录很多信息,用于开发和测试</span>
<span class="token comment" spellcheck="true"># varbose 有用的信息,但是没有debug那么多</span>
<span class="token comment" spellcheck="true"># notice 普通的verbose用于生产环境</span>
<span class="token comment" spellcheck="true"># warning  纪录非常重要或严重的信息</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 配置log文件地址</span>
<span class="token comment" spellcheck="true"># 默认是stdout,标准输出,如果是后台模式会输出到/dev/null</span>
<span class="token comment" spellcheck="true"># logfile ""</span>
logfile <span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>redis<span class="token operator">/</span>redis<span class="token punctuation">.</span>log
<span class="token comment" spellcheck="true"># 是否打开记录syslog功能</span>
<span class="token comment" spellcheck="true"># syslog-enabled no</span>
<span class="token comment" spellcheck="true"># syslog的标识符</span>
<span class="token comment" spellcheck="true"># syslog-ident redis</span>
<span class="token comment" spellcheck="true"># 日志的来源、设备</span>
<span class="token comment" spellcheck="true"># syslog-facility local0</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 可用的数据库数</span>
<span class="token comment" spellcheck="true"># 默认是16</span>
databases <span class="token number">16</span>
<span class="token comment" spellcheck="true">################################ 快照  #################################</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 保存数据到磁盘,格式如下</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true">#   save &lt;seconds> &lt;changes></span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 指出在多长时间内,有多少次的更新操作,就将数据同步到数据文件中</span>
<span class="token comment" spellcheck="true"># 默认配置</span>
<span class="token comment" spellcheck="true"># save 900 1  900秒内至少有1个key被改变</span>
<span class="token comment" spellcheck="true"># save 300 10  300秒内至少有10个key被改变</span>
<span class="token comment" spellcheck="true"># save 60 10000 60秒类至少有10000个key被改变</span>
save <span class="token number">900</span> <span class="token number">1</span>
save <span class="token number">300</span> <span class="token number">10</span>
save <span class="token number">60</span> <span class="token number">10000</span>
<span class="token comment" spellcheck="true"># 存储到本地数据时,时候压缩数据,默认是yes</span>
rdbcompression yes
<span class="token comment" spellcheck="true"># 本地持久化数据库文件名称,默认是dump.rdb</span>
dbfilename dump<span class="token punctuation">.</span>rdb
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 当rdb持久化出现错误后，是否依然进行继续进行工作，</span>
<span class="token comment" spellcheck="true"># yes：不能进行工作，</span>
<span class="token comment" spellcheck="true"># no：可以继续进行工作，</span>
<span class="token comment" spellcheck="true"># 可以通过info中的rdb_last_bgsave_status了解RDB持久化是否有错误</span>
stop<span class="token operator">-</span>writes<span class="token operator">-</span>on<span class="token operator">-</span>bgsave<span class="token operator">-</span>error yes
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 使用压缩rdb文件</span>
<span class="token comment" spellcheck="true"># yes：压缩，但是需要一些cpu的消耗</span>
<span class="token comment" spellcheck="true"># no：不压缩，需要更多的磁盘空间</span>
rdbcompression yes
<span class="token comment" spellcheck="true"># 是否校验rdb文件</span>
rdbchecksum yes
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 工作目录</span>
<span class="token comment" spellcheck="true"># 数据库镜像备份的文件放置的路径</span>
<span class="token comment" spellcheck="true"># 这里的路径跟文件名要分开配置是因为redis在进行备份时,先会把当前数据库的状态写入到一个临时文件中,等备份完成时,再把该临时文件替换成上面指定的文件,而这里的临时文件和上面所配置的备份文件都会放在这个指定的路径当中</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 注意这里必须指定一个目录,而不是文件</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true">################################# 复制 #################################</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 主从复制,设置主从服务器</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true">#   +---------------------+        +-----------------+</span>
<span class="token comment" spellcheck="true">#   |      Master              | ---> |    Replica        |</span>
<span class="token comment" spellcheck="true">#   | (receive writes)  |        |  (exact copy) |</span>
<span class="token comment" spellcheck="true">#   +---------------------+        +-----------------+</span>
<span class="token comment" spellcheck="true"># 1.ridis 是异步复制的</span>
<span class="token comment" spellcheck="true"># 2.复制是自动的.</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># replicaof &lt;masterip> &lt;masterport></span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 当master服务设置了密码保护时,slave服务器连接master需要密码</span>
<span class="token comment" spellcheck="true"># masterauth &lt;master-password></span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 当slave同master失去连接,或者仍然在进行复制是,slave有2种方式运行</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 1.如果slave-server-stale-date=yes (默认),slave会继续响应客户端请求</span>
<span class="token comment" spellcheck="true"># 2.如果为no,slave服务器对多有的命令发出错误信息'SYNC with master in progress',除去NFO, replicaOF, AUTH, PING, SHUTDOWN, REPLCONF, ROLE, CONFIG,  SUBSCRIBE, UNSUBSCRIBE, PSUBSCRIBE, PUNSUBSCRIBE, PUBLISH, PUBSUB     COMMAND, POST, HOST: and LATENCY.命令</span>
<span class="token comment" spellcheck="true">#</span>
slave<span class="token operator">-</span>serve<span class="token operator">-</span>stale<span class="token operator">-</span>data yes
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># slave服务器读写配置</span>
<span class="token comment" spellcheck="true"># 默认情况下是只读的（yes）</span>
<span class="token comment" spellcheck="true"># 修改成no，可读可写（不建议）</span>
slave<span class="token operator">-</span>read<span class="token operator">-</span>only yes
<span class="token comment" spellcheck="true"># 是否使用socket方式复制数据。目前redis复制提供两种方式，disk和socket。如果新的slave连上来或者重连的slave无法部分同步，就会执行全量同步，master会生成rdb文件。有2种方式：disk方式是master创建一个新的进程把rdb文件保存到磁盘，再把磁盘上的rdb文件传递给slave。socket是master创建一个新的进程，直接把rdb文件以socket的方式发给slave。disk方式的时候，当一个rdb保存的过程中，多个slave都能共享这个rdb文件。socket的方式就的一个个slave顺序复制。在磁盘速度缓慢，网速快的情况下推荐用socket方式。</span>
repl<span class="token operator">-</span>diskless<span class="token operator">-</span>sync no
<span class="token comment" spellcheck="true"># diskless复制的延迟时间，防止设置为0。一旦复制开始，节点不会再接收新slave的复制请求直到下一个rdb传输。所以最好等待一段时间，等更多的slave连上来。</span>
repl<span class="token operator">-</span>diskless<span class="token operator">-</span>sync<span class="token operator">-</span>delay <span class="token number">5</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># slave会按照一个时间间隔向master 发送 PINGs,设置时间间隔,默认是10秒</span>
<span class="token comment" spellcheck="true"># repl-ping-replica-period 10</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 设置slave和master数据传输时间间隔</span>
<span class="token comment" spellcheck="true"># repl-timeout 60</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 是否禁止复制tcp链接的tcp nodelay参数，可传递yes或者no。默认是no，即使用tcp nodelay。如果master设置了yes来禁止tcp nodelay设置，在把数据复制给slave的时候，会减少包的数量和更小的网络带宽。但是这也可能带来数据的延迟。默认我们推荐更小的延迟，但是在数据量传输很大的场景下，建议选择yes。</span>
repl<span class="token operator">-</span>disable<span class="token operator">-</span>tcp<span class="token operator">-</span>nodelay no
<span class="token comment" spellcheck="true"># 复制缓冲区大小，这是一个环形复制缓冲区，用来保存最新复制的命令。这样在slave离线的时候，不需要完全复制master的数据，如果可以执行部分同步，只需要把缓冲区的部分数据复制给slave，就能恢复正常复制状态。缓冲区的大小越大，slave离线的时间可以更长，复制缓冲区只有在有slave连接的时候才分配内存。没有slave的一段时间，内存会被释放出来，默认1m。</span>
repl<span class="token operator">-</span>backlog<span class="token operator">-</span>size 5mb
<span class="token comment" spellcheck="true"># master没有slave一段时间会释放复制缓冲区的内存，repl-backlog-ttl用来设置该时间长度。单位为秒。</span>
repl<span class="token operator">-</span>backlog<span class="token operator">-</span>ttl <span class="token number">3600</span>
<span class="token comment" spellcheck="true"># 当master不可用，Sentinel会根据slave的优先级选举一个master。最低的优先级的slave，当选master。而配置成0，永远不会被选举。</span>
slave<span class="token operator">-</span>priority <span class="token number">100</span>
<span class="token comment" spellcheck="true"># redis提供了可以让master停止写入的方式，如果配置了min-slaves-to-write，健康的slave的个数小于N，mater就禁止写入。master最少得有多少个健康的slave存活才能执行写命令。这个配置虽然不能保证N个slave都一定能接收到master的写操作，但是能避免没有足够健康的slave的时候，master不能写入来避免数据丢失。设置为0是关闭该功能。</span>
<span class="token comment" spellcheck="true"># min-slaves-to-write 3</span>
<span class="token comment" spellcheck="true"># 延迟小于min-slaves-max-lag秒的slave才认为是健康的slave。</span>
min<span class="token operator">-</span>slaves<span class="token operator">-</span>max<span class="token operator">-</span>lag <span class="token number">10</span>
<span class="token comment" spellcheck="true"># 设置1或另一个设置为0禁用这个特性。</span>
min<span class="token operator">-</span>slaves<span class="token operator">-</span>max<span class="token operator">-</span>lag <span class="token keyword">is</span> set to <span class="token number">10</span><span class="token punctuation">.</span>

<span class="token comment" spellcheck="true">###########################SECURITY ###################################</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># 设置客户端连接后进行任何其他指定前需要使用的密码</span>
<span class="token comment" spellcheck="true">#  警告:因为redis速度相当快,所以在一台比较好的服务器下,一个外部的用户可以在一秒钟进行150K次的密码尝试,这意味着你需要指定非常非常强大的密码来防止暴力破解.</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># Example:</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span>
<span class="token comment" spellcheck="true"># </span>
<span class="token comment" spellcheck="true"># 如果要删除一个命令,可以直接重命名它为一个空字符串</span>
<span class="token comment" spellcheck="true">#</span>
<span class="token comment" spellcheck="true"># rename-command CONFIG ""</span>
<span class="token comment" spellcheck="true"># 更多设置参照配置文件.</span>

<span class="token comment" spellcheck="true">########################AOF##########################</span>
<span class="token comment" spellcheck="true"># 默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。但是redis如果中途宕机，会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性。Redis会把每次写入的数据在接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。</span>
appendonly no
<span class="token comment" spellcheck="true"># aof文件名</span>
appendfilename <span class="token string">"appendonly.aof"</span>
<span class="token comment" spellcheck="true"># aof持久化策略的配置</span>
<span class="token comment" spellcheck="true"># no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。</span>
<span class="token comment" spellcheck="true"># always表示每次写入都执行fsync，以保证数据同步到磁盘。</span>
<span class="token comment" spellcheck="true"># everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。</span>
appendfsync everysec
<span class="token comment" spellcheck="true"># 在aof重写或者写入rdb文件的时候，会执行大量IO，此时对于everysec和always的aof模式来说，执行fsync会造成阻塞过长时间，no-appendfsync-on-rewrite字段设置为默认设置为no。如果对延迟要求很高的应用，这个字段可以设置为yes，否则还是设置为no，这样对持久化特性来说这是更安全的选择。设置为yes表示rewrite期间对新写操作不fsync,暂时存在内存中,等rewrite完成后再写入，默认为no，建议yes。Linux的默认fsync策略是30秒。可能丢失30秒数据。</span>
no<span class="token operator">-</span>appendfsync<span class="token operator">-</span>on<span class="token operator">-</span>rewrite no
<span class="token comment" spellcheck="true"># aof自动重写配置。当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，即当aof文件增长到一定大小的时候Redis能够调用bgrewriteaof对日志文件进行重写。当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。</span>
auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>percentage <span class="token number">100</span>
<span class="token comment" spellcheck="true"># 设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写</span>
auto<span class="token operator">-</span>aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>min<span class="token operator">-</span>size 64mb
<span class="token comment" spellcheck="true"># aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。重启可能发生在redis所在的主机操作系统宕机后，尤其在ext4文件系统没有加上data=ordered选项（redis宕机或者异常终止不会造成尾部不完整现象。）出现这种现象，可以选择让redis退出，或者导入尽可能多的数据。如果选择的是yes，当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。如果是no，用户必须手动redis-check-aof修复AOF文件才可以。</span>
aof<span class="token operator">-</span>load<span class="token operator">-</span>truncated yes

<span class="token comment" spellcheck="true">###############clients#####################</span>

<span class="token comment" spellcheck="true"># 设置能连上redis的最大客户端连接数量。默认是10000个客户端连接。由于redis不区分连接是客户端连接还是内部打开文件或者和slave连接等，所以maxclients最小建议设置到32。如果超过了maxclients，redis会给新的连接发送’max number of clients reached’，并关闭连接。</span>
maxclients <span class="token number">10000</span>
<span class="token comment" spellcheck="true"># redis配置的最大内存容量。当内存满了，需要配合maxmemory-policy策略进行处理。注意slave的输出缓冲区是不计算在maxmemory内的。所以为了防止主机内存使用完，建议设置的maxmemory需要更小一些。</span>
maxmemory <span class="token operator">&lt;</span>bytes<span class="token operator">></span>
<span class="token comment" spellcheck="true"># 内存容量超过maxmemory后的处理策略。</span>
<span class="token comment" spellcheck="true"># volatile-lru：利用LRU算法移除设置过过期时间的key。</span>
<span class="token comment" spellcheck="true"># volatile-random：随机移除设置过过期时间的key。</span>
<span class="token comment" spellcheck="true"># volatile-ttl：移除即将过期的key，根据最近过期时间来删除（辅以TTL）</span>
<span class="token comment" spellcheck="true"># allkeys-lru：利用LRU算法移除任何key。</span>
<span class="token comment" spellcheck="true"># allkeys-random：随机移除任何key。</span>
<span class="token comment" spellcheck="true"># noeviction：不移除任何key，只是返回一个写错误。</span>
<span class="token comment" spellcheck="true"># 上面的这些驱逐策略，如果redis没有合适的key驱逐，对于写命令，还是会返回错误。redis将不再接收写请求，只接收get请求。</span>
maxmemory<span class="token operator">-</span>policy noeviction
<span class="token comment" spellcheck="true"># lru检测的样本数。使用lru或者ttl淘汰算法，从需要淘汰的列表中随机选择sample个key，选出闲置时间最长的key移除。</span>
maxmemory<span class="token operator">-</span>samples <span class="token number">5</span>
<span class="token comment" spellcheck="true"># 如果达到最大时间限制（毫秒），redis会记个log，然后返回error。当一个脚本超过了最大时限。只有SCRIPT KILL和SHUTDOWN NOSAVE可以用。第一个可以杀没有调write命令的东西。要是已经调用了write，只能用第二个命令杀。</span>
lua<span class="token operator">-</span>time<span class="token operator">-</span>limit <span class="token number">5000</span>

<span class="token comment" spellcheck="true">#######################REDIS CLUSTER#############</span>
<span class="token comment" spellcheck="true"># 集群开关，默认是不开启集群模式。</span>
cluster<span class="token operator">-</span>enabled yes
<span class="token comment" spellcheck="true"># 集群配置文件的名称，每个节点都有一个集群相关的配置文件，持久化保存集群的信息。这个文件并不需要手动配置，这个配置文件有Redis生成并更新，每个Redis集群节点需要一个单独的配置文件，请确保与实例运行的系统中配置文件名称不冲突</span>
<span class="token comment" spellcheck="true"># cluster-config-file nodes-a.conf</span>
<span class="token comment" spellcheck="true"># 节点互连超时的阀值。集群节点超时毫秒数</span>
<span class="token comment" spellcheck="true"># cluster-node-timeout 15000</span>
<span class="token comment" spellcheck="true"># 在进行故障转移的时候，全部slave都会请求申请为master，但是有些slave可能与master断开连接一段时间了，导致数据过于陈旧，这样的slave不应该被提升为master。该参数就是用来判断slave节点与master断线的时间是否过长。判断方法是：</span>
<span class="token comment" spellcheck="true"># 比较slave断开连接的时间和(node-timeout * slave-validity-factor) +repl-ping-slave-period</span>
<span class="token comment" spellcheck="true"># 如果节点超时时间为三十秒, 并且slave-validity-factor为10,假设默认的repl-ping-slave-period是10秒，即如果超过310秒slave将不会尝试进行故障转移</span>
cluster<span class="token operator">-</span>slave<span class="token operator">-</span>validity<span class="token operator">-</span>factor <span class="token number">10</span>
<span class="token comment" spellcheck="true"># master的slave数量大于该值，slave才能迁移到其他孤立master上，如这个参数若被设为2，那么只有当一个主节点拥有2 个可工作的从节点时，它的一个从节点会尝试迁移。</span>
cluster<span class="token operator">-</span>migration<span class="token operator">-</span>barrier <span class="token number">1</span>
<span class="token comment" spellcheck="true"># 默认情况下，集群全部的slot有节点负责，集群状态才为ok，才能提供服务。设置为no，可以在slot没有全部分配的时候提供服务。不建议打开该配置，这样会造成分区的时候，小分区的master一直在接受写请求，而造成很长时间数据不一致。</span>
cluster<span class="token operator">-</span>require<span class="token operator">-</span>full<span class="token operator">-</span>coverage yes

<span class="token comment" spellcheck="true">########################SLOW LOG###############</span>
<span class="token comment" spellcheck="true"># slog log是用来记录redis运行中执行比较慢的命令耗时。当命令的执行超过了指定时间，就记录在slow log中，slog log保存在内存中，所以没有IO操作。</span>
<span class="token comment" spellcheck="true"># 执行时间比slowlog-log-slower-than大的请求记录到slowlog里面，单位是微秒，所以1000000就是1秒。注意，负数时间会禁用慢查询日志，而0则会强制记录所有命令。</span>
slowlog<span class="token operator">-</span>log<span class="token operator">-</span>slower<span class="token operator">-</span>than <span class="token number">10000</span>
<span class="token comment" spellcheck="true"># 慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录会被删掉。这个长度没有限制。只要有足够的内存就行。你可以通过 SLOWLOG RESET 来释放内存。</span>
slowlog<span class="token operator">-</span>max<span class="token operator">-</span>len <span class="token number">128</span>
<span class="token comment" spellcheck="true"># 延迟监控功能是用来监控redis中执行比较缓慢的一些操作，用LATENCY打印redis实例在跑命令时的耗时图表。只记录大于等于下边设置的值的操作。0的话，就是关闭监视。默认延迟监控功能是关闭的，如果你需要打开，也可以通过CONFIG SET命令动态设置</span>
latency<span class="token operator">-</span>monitor<span class="token operator">-</span>threshold <span class="token number">0</span>

<span class="token comment" spellcheck="true">###################EVENT NOTIFICATION###############</span>
<span class="token comment" spellcheck="true"># 键空间通知使得客户端可以通过订阅频道或模式，来接收那些以某种方式改动了 Redis 数据集的事件。因为开启键空间通知功能需要消耗一些 CPU ，所以在默认配置下，该功能处于关闭状态。</span>
<span class="token comment" spellcheck="true"># notify-keyspace-events的参数可以是以下字符的任意组合，它指定了服务器该发送哪些类型的通知：</span>
<span class="token comment" spellcheck="true">##K 键空间通知，所有通知以 __keyspace@__ 为前缀</span>
<span class="token comment" spellcheck="true">##E 键事件通知，所有通知以 __keyevent@__ 为前缀</span>
<span class="token comment" spellcheck="true">##g DEL 、 EXPIRE 、 RENAME 等类型无关的通用命令的通知</span>
<span class="token comment" spellcheck="true">##$ 字符串命令的通知</span>
<span class="token comment" spellcheck="true">##l 列表命令的通知</span>
<span class="token comment" spellcheck="true">##s 集合命令的通知</span>
<span class="token comment" spellcheck="true">##h 哈希命令的通知</span>
<span class="token comment" spellcheck="true">##z 有序集合命令的通知</span>
<span class="token comment" spellcheck="true">##x 过期事件：每当有过期键被删除时发送</span>
<span class="token comment" spellcheck="true">##e 驱逐(evict)事件：每当有键因为 maxmemory 政策而被删除时发送</span>
<span class="token comment" spellcheck="true">##A 参数 g$lshzxe 的别名</span>
<span class="token comment" spellcheck="true"># 输入的参数中至少要有一个 K 或者 E，否则的话，不管其余的参数是什么，都不会有任何 通知被分发。</span>
notify<span class="token operator">-</span>keyspace<span class="token operator">-</span>events <span class="token string">""</span>

<span class="token comment" spellcheck="true">##################ADVANCED CONFIG##############</span>
<span class="token comment" spellcheck="true"># 数据量小于等于hash-max-ziplist-entries的用ziplist，大于hash-max-ziplist-entries用hash</span>
hash<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>entries <span class="token number">512</span>
<span class="token comment" spellcheck="true"># value大小小于等于hash-max-ziplist-value的用ziplist，大于hash-max-ziplist-value用hash</span>
hash<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>value <span class="token number">64</span>
<span class="token comment" spellcheck="true"># -5:最大大小：64 KB&lt;--不建议用于正常工作负载</span>
<span class="token comment" spellcheck="true"># -4:最大大小：32 KB&lt;--不推荐</span>
<span class="token comment" spellcheck="true"># -3:最大大小：16 KB&lt;--可能不推荐</span>
<span class="token comment" spellcheck="true"># -2:最大大小：8kb&lt;--良好</span>
<span class="token comment" spellcheck="true"># -1:最大大小：4kb&lt;--良好</span>
list<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>size <span class="token operator">-</span><span class="token number">2</span>
<span class="token comment" spellcheck="true"># 0:禁用所有列表压缩</span>
<span class="token comment" spellcheck="true"># 1：深度1表示“在列表中的1个节点之后才开始压缩，</span>
<span class="token comment" spellcheck="true"># 从头部或尾部</span>
<span class="token comment" spellcheck="true"># 所以：【head】->node->node->…->node->【tail】</span>
<span class="token comment" spellcheck="true"># [头部]，[尾部]将始终未压缩；内部节点将压缩。</span>
<span class="token comment" spellcheck="true"># 2:[头部]->[下一步]->节点->节点->…->节点->[上一步]->[尾部]</span>
<span class="token comment" spellcheck="true"># 2这里的意思是：不要压缩头部或头部->下一个或尾部->上一个或尾部，</span>
<span class="token comment" spellcheck="true"># 但是压缩它们之间的所有节点。</span>
<span class="token comment" spellcheck="true"># 3:[头部]->[下一步]->[下一步]->节点->节点->…->节点->[上一步]->[上一步]->[尾部]</span>
list<span class="token operator">-</span>compress<span class="token operator">-</span>depth <span class="token number">0</span>
<span class="token comment" spellcheck="true"># 数据量小于等于set-max-intset-entries用iniset，大于set-max-intset-entries用set</span>
set<span class="token operator">-</span>max<span class="token operator">-</span>intset<span class="token operator">-</span>entries <span class="token number">512</span>
<span class="token comment" spellcheck="true"># 数据量小于等于zset-max-ziplist-entries用ziplist，大于zset-max-ziplist-entries用zset</span>
zset<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>entries <span class="token number">128</span>
<span class="token comment" spellcheck="true"># value大小小于等于zset-max-ziplist-value用ziplist，大于zset-max-ziplist-value用zset</span>
zset<span class="token operator">-</span>max<span class="token operator">-</span>ziplist<span class="token operator">-</span>value <span class="token number">64</span>
<span class="token comment" spellcheck="true"># value大小小于等于hll-sparse-max-bytes使用稀疏数据结构（sparse），大于hll-sparse-max-bytes使用稠密的数据结构（dense）。一个比16000大的value是几乎没用的，建议的value大概为3000。如果对CPU要求不高，对空间要求较高的，建议设置到10000左右</span>
hll<span class="token operator">-</span>sparse<span class="token operator">-</span>max<span class="token operator">-</span>bytes <span class="token number">3000</span>
<span class="token comment" spellcheck="true"># 宏观节点的最大流/项目的大小。在流数据结构是一个基数</span>
<span class="token comment" spellcheck="true"># 树节点编码在这项大的多。利用这个配置它是如何可能#大节点配置是单字节和</span>
<span class="token comment" spellcheck="true"># 最大项目数，这可能包含了在切换到新节点的时候</span>
<span class="token comment" spellcheck="true"># appending新的流条目。如果任何以下设置来设置</span>
<span class="token comment" spellcheck="true"># ignored极限是零，例如，操作系统，它有可能只是一集通过设置限制最大#纪录到最大字节0和最大输入到所需的值</span>
stream<span class="token operator">-</span>node<span class="token operator">-</span>max<span class="token operator">-</span>bytes <span class="token number">4096</span>
stream<span class="token operator">-</span>node<span class="token operator">-</span>max<span class="token operator">-</span>entries <span class="token number">100</span>
<span class="token comment" spellcheck="true"># Redis将在每100毫秒时使用1毫秒的CPU时间来对redis的hash表进行重新hash，可以降低内存的使用。当你的使用场景中，有非常严格的实时性需要，不能够接受Redis时不时的对请求有2毫秒的延迟的话，把这项配置为no。如果没有这么严格的实时性要求，可以设置为yes，以便能够尽可能快的释放内存</span>
activerehashing yes
<span class="token comment" spellcheck="true"># 对客户端输出缓冲进行限制可以强迫那些不从服务器读取数据的客户端断开连接，用来强制关闭传输缓慢的客户端。</span>
<span class="token comment" spellcheck="true"># 对于normal client，第一个0表示取消hardlimit，第二个0和第三个0表示取消soft limit，normal client默认取消限制，因为如果没有寻问，他们是不会接收数据</span>
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit normal <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>
<span class="token comment" spellcheck="true"># 对于slave client和MONITERclient，如果client-output-buffer一旦超过256mb，又或者超过64mb持续60秒，那么服务器就会立即断开客户端连接</span>
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit replica 256mb 64mb <span class="token number">60</span>
<span class="token comment" spellcheck="true"># 对于pubsub client，如果client-output-buffer一旦超过32mb，又或者超过8mb持续60秒，那么服务器就会立即断开客户端连接</span>
client<span class="token operator">-</span>output<span class="token operator">-</span>buffer<span class="token operator">-</span>limit pubsub 32mb 8mb <span class="token number">60</span>
<span class="token comment" spellcheck="true"># 这是客户端查询的缓存极限值大小</span>
client<span class="token operator">-</span>query<span class="token operator">-</span>buffer<span class="token operator">-</span>limit 1gb
<span class="token comment" spellcheck="true"># 在redis协议中，批量请求，即表示单个字符串，通常限制为512MB。但是您可以更改此限制。</span>
<span class="token comment" spellcheck="true"># proto-max-bulk-len 512mb</span>
<span class="token comment" spellcheck="true"># redis执行任务的频率为1s除以hz</span>
hz <span class="token number">10</span>
<span class="token comment" spellcheck="true"># 当启用动态赫兹时，实际配置的赫兹将用作作为基线，但实际配置的赫兹值的倍数</span>
<span class="token comment" spellcheck="true"># 在连接更多客户端后根据需要使用。这样一个闲置的实例将占用很少的CPU时间，而繁忙的实例将反应更灵敏</span>
dynamic<span class="token operator">-</span>hz yes
<span class="token comment" spellcheck="true"># 在aof重写的时候，如果打开了aof-rewrite-incremental-fsync开关，系统会每32MB执行一次fsync。这对于把文件写入磁盘是有帮助的，可以避免过大的延迟峰值</span>
aof<span class="token operator">-</span>rewrite<span class="token operator">-</span>incremental<span class="token operator">-</span>fsync yes
<span class="token comment" spellcheck="true"># 在rdb保存的时候，如果打开了rdb-save-incremental-fsync开关，系统会每32MB执行一次fsync。这对于把文件写入磁盘是有帮助的，可以避免过大的延迟峰值</span>
rdb<span class="token operator">-</span>save<span class="token operator">-</span>incremental<span class="token operator">-</span>fsync yes

<span class="token comment" spellcheck="true">###################### ACTIVE DEFRAGMENTATION #####################</span>

<span class="token comment" spellcheck="true"># 已启用活动碎片整理</span>
<span class="token comment" spellcheck="true"># activedefrag yes</span>
<span class="token comment" spellcheck="true"># 启动活动碎片整理的最小碎片浪费量</span>
<span class="token comment" spellcheck="true"># active-defrag-ignore-bytes 100mb</span>
<span class="token comment" spellcheck="true"># 启动活动碎片整理的最小碎片百分比</span>
<span class="token comment" spellcheck="true"># active-defrag-threshold-lower 10</span>
<span class="token comment" spellcheck="true"># 我们使用最大努力的最大碎片百分比</span>
<span class="token comment" spellcheck="true"># active-defrag-threshold-upper 100</span>
<span class="token comment" spellcheck="true"># 以CPU百分比表示的碎片整理的最小工作量</span>
<span class="token comment" spellcheck="true"># active-defrag-cycle-min 5</span>
<span class="token comment" spellcheck="true"># 在CPU的百分比最大的努力和碎片整理</span>
<span class="token comment" spellcheck="true"># active-defrag-cycle-max 75</span>
<span class="token comment" spellcheck="true"># 将从中处理的set/hash/zset/list字段的最大数目</span>
<span class="token comment" spellcheck="true"># 主词典扫描</span>
<span class="token comment" spellcheck="true"># active-defrag-max-scan-fields 1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="4-redis-工具"><a href="#4-redis-工具" class="headerlink" title="4.redis 工具"></a>4.<code>redis</code> 工具</h3><blockquote><p>在<code>src</code> 中生成了以下<code>redis</code> 工具</p><ul><li><code>redis-server</code> :主服务工具</li><li><code>redis-cli</code> :命令行客户端</li><li><code>redis-benchmark</code> :性能测试工具</li><li><code>redis-check-aof</code> :<code>AOF</code> 文件修复工具</li><li><code>redis-check-rdb</code>:<code>rdb</code> 文件修复工具</li><li><code>redis-sentinal</code> :集群管理工具</li><li><code>redis.conf</code>:配置文件</li></ul></blockquote><h3 id="5-连接redis"><a href="#5-连接redis" class="headerlink" title="5.连接redis"></a>5.连接<code>redis</code></h3><blockquote><p>使用客户端工具<code>redis-cli</code></p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost src]# ./redis-cli -h
redis-cli 5.0.7

Usage: redis-cli [OPTIONS] [cmd [arg [arg ...]]]
-h <hostname>      Server hostname (default: 127.0.0.1).
-p <port>          Server port (default: 6379).
-s <socket>        Server socket (overrides hostname and port).
-a <password>      Password to use when connecting to the server.
               You can also use the REDISCLI_AUTH environment
               variable to pass this password more safely
               (if both are used, this argument takes predecence).
-u <uri>           Server URI.
-r <repeat>        Execute specified command N times.
-i <interval>      When -r is used, waits <interval> seconds per command.
               It is possible to specify sub-second times like -i 0.1.
-n <db>            Database number.
-x                 Read last argument from STDIN.
-d <delimiter>     Multi-bulk delimiter in for raw formatting (default: \n).
-c                 Enable cluster mode (follow -ASK and -MOVED redirections).
--raw              Use raw formatting for replies (default when STDOUT is
               not a tty).
--no-raw           Force formatted output even when STDOUT is not a tty.
--csv              Output in CSV format.
--stat             Print rolling stats about server: mem, clients, ...
--latency          Enter a special mode continuously sampling latency.
               If you use this mode in an interactive session it runs
               forever displaying real-time stats. Otherwise if --raw or
               --csv is specified, or if you redirect the output to a non
               TTY, it samples the latency for 1 second (you can use
               -i to change the interval), then produces a single output
               and exits.
--latency-history  Like --latency but tracking latency changes over time.
               Default time interval is 15 sec. Change it using -i.
--latency-dist     Shows latency as a spectrum, requires xterm 256 colors.
               Default time interval is 1 sec. Change it using -i.
--lru-test <keys>  Simulate a cache workload with an 80-20 distribution.
--replica          Simulate a replica showing commands received from the master.
--rdb <filename>   Transfer an RDB dump from remote server to local file.
--pipe             Transfer raw Redis protocol from stdin to server.
--pipe-timeout <n> In --pipe mode, abort with error if after sending all data.
               no reply is received within <n> seconds.
               Default timeout: 30. Use 0 to wait forever.
--bigkeys          Sample Redis keys looking for keys with many elements (complexity).
--memkeys          Sample Redis keys looking for keys consuming a lot of memory.
--memkeys-samples <n> Sample Redis keys looking for keys consuming a lot of memory.
               And define number of key elements to sample
--hotkeys          Sample Redis keys looking for hot keys.
               only works when maxmemory-policy is *lfu.
--scan             List all keys using the SCAN command.
--pattern <pat>    Useful with --scan to specify a SCAN pattern.
--intrinsic-latency <sec> Run a test to measure intrinsic system latency.
               The test will run for the specified amount of seconds.
--eval <file>      Send an EVAL command using the Lua script at <file>.
--ldb              Used with --eval enable the Redis Lua debugger.
--ldb-sync-mode    Like --ldb but uses the synchronous Lua debugger, in
               this mode the server is blocked and script changes are
               not rolled back from the server memory.
--cluster <command> [args...] [opts...]
               Cluster Manager command and arguments (see below).
--verbose          Verbose mode.
--no-auth-warning  Don't show warning message when using password on command
               line interface.
--help             Output this help and exit.
--version          Output version and exit.

[root@localhost src]# ./redis-cli
127.0.0.1:6379> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></command></file></file></sec></pat></n></n></n></filename></keys></delimiter></db></interval></interval></repeat></uri></password></socket></port></hostname></code></pre></blockquote><h3 id="6-关闭redis"><a href="#6-关闭redis" class="headerlink" title="6.关闭redis"></a>6.关闭<code>redis</code></h3><blockquote><p>强行关闭<code>redis</code> 可能会导致数据丢失,应该使用客户端工具关闭<code>redis</code></p><pre class="line-numbers language-shell"><code class="language-shell">[root@localhost src]# ./redis-cli shutdown<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ningwenyan/My_chat_picgo/wechat.png" alt="wechat"></p><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css"></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">文彦</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://www.kningyuan.eu.org/posts/23605.html">https://www.kningyuan.eu.org/posts/23605.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">文彦</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/redis/"><span class="chip bg-color">redis</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/share/js/social-share.min.js"></script></div></div></div><style>#reward{margin:40px 0;text-align:center}#reward .reward-link{font-size:1.4rem;line-height:38px}#reward .btn-floating:hover{box-shadow:0 6px 12px rgba(0,0,0,.2),0 5px 15px rgba(0,0,0,.2)}#rewardModal{width:320px;height:350px}#rewardModal .reward-title{margin:15px auto;padding-bottom:5px}#rewardModal .modal-content{padding:10px}#rewardModal .close{position:absolute;right:15px;top:15px;color:rgba(0,0,0,.5);font-size:1.3rem;line-height:20px;cursor:pointer}#rewardModal .close:hover{color:#ef5350;transform:scale(1.3);-moz-transform:scale(1.3);-webkit-transform:scale(1.3);-o-transform:scale(1.3)}#rewardModal .reward-tabs{margin:0 auto;width:210px}.reward-tabs .tabs{height:38px;margin:10px auto;padding-left:0}.reward-content ul{padding-left:0!important}.reward-tabs .tabs .tab{height:38px;line-height:38px}.reward-tabs .tab a{color:#fff;background-color:#ccc}.reward-tabs .tab a:hover{background-color:#ccc;color:#fff}.reward-tabs .wechat-tab .active{color:#fff!important;background-color:#22ab38!important}.reward-tabs .alipay-tab .active{color:#fff!important;background-color:#019fe8!important}.reward-tabs .reward-img{width:210px;height:210px}</style><div id="reward"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">你的赏识是我前进的动力</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li></ul><div id="alipay"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="wechat"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div></div></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script></div></div><style>.valine-card{margin:1.5rem auto}.valine-card .card-content{padding:20px 20px 5px 20px}#vcomments textarea{box-sizing:border-box;background:url(/medias/comment_bg.png) 100% 100% no-repeat}#vcomments p{margin:2px 2px 10px;font-size:1.05rem;line-height:1.78rem}#vcomments blockquote p{text-indent:.2rem}#vcomments a{padding:0 2px;color:#4cbf30;font-weight:500;text-decoration:none}#vcomments img{max-width:100%;height:auto;cursor:pointer}#vcomments ol li{list-style-type:decimal}#vcomments ol,ul{display:block;padding-left:2em;word-spacing:.05rem}#vcomments ul li,ol li{display:list-item;line-height:1.8rem;font-size:1rem}#vcomments ul li{list-style-type:disc}#vcomments ul ul li{list-style-type:circle}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}#vcomments table,td,th{border:0}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments h1{font-size:1.85rem;font-weight:700;line-height:2.2rem}#vcomments h2{font-size:1.65rem;font-weight:700;line-height:1.9rem}#vcomments h3{font-size:1.45rem;font-weight:700;line-height:1.7rem}#vcomments h4{font-size:1.25rem;font-weight:700;line-height:1.5rem}#vcomments h5{font-size:1.1rem;font-weight:700;line-height:1.4rem}#vcomments h6{font-size:1rem;line-height:1.3rem}#vcomments p{font-size:1rem;line-height:1.5rem}#vcomments hr{margin:12px 0;border:0;border-top:1px solid #ccc}#vcomments blockquote{margin:15px 0;border-left:5px solid #42b983;padding:1rem .8rem .3rem .8rem;color:#666;background-color:rgba(66,185,131,.1)}#vcomments pre{font-family:monospace,monospace;padding:1.2em;margin:.5em 0;background:#272822;overflow:auto;border-radius:.3em;tab-size:4}#vcomments code{font-family:monospace,monospace;padding:1px 3px;font-size:.92rem;color:#e96900;background-color:#f8f8f8;border-radius:2px}#vcomments pre code{font-family:monospace,monospace;padding:0;color:#e8eaf6;background-color:#272822}#vcomments pre[class*=language-]{padding:1.2em;margin:.5em 0}#vcomments code[class*=language-],pre[class*=language-]{color:#e8eaf6}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}#vcomments b,strong{font-weight:700}#vcomments dfn{font-style:italic}#vcomments small{font-size:85%}#vcomments cite{font-style:normal}#vcomments mark{background-color:#fcf8e3;padding:.2em}#vcomments table,td,th{padding:12px 13px;border:1px solid #dfe2e5}table tr:nth-child(2n),thead{background-color:#fafafa}#vcomments table th{background-color:#f2f2f2;min-width:80px}#vcomments table td{min-width:80px}#vcomments [type=checkbox]:not(:checked),[type=checkbox]:checked{position:inherit;margin-left:-1.3rem;margin-right:.4rem;margin-top:-1px;vertical-align:middle;left:unset;visibility:visible}</style><div class="card valine-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="vcomments" class="card-content" style="display:grid"></div></div><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/valine/av-min.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/valine/Valine.min.js"></script><script>new Valine({el:"#vcomments",appId:"4D08X5mQ4KUr126NW8IvCzQ7-gzGzoHsz",appKey:"W8Ga6qdP1wi5QLHkirRTdK96",notify:!1,verify:!1,visitor:!0,avatar:"mm",pageSize:"10",lang:"zh-cn",placeholder:"ヾﾉ≧∀≦)o来啊，快活啊!"})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/37213.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/My_chat_picgo/2020-9-27/1601218579668-10303.png" class="responsive-img" alt="redis客户端配置"> <span class="card-title">redis客户端配置</span></div></a><div class="card-content article-content"><div class="summary block-with-text">redis客户端配置</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-09-28 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/redis/" class="post-category">redis</a></span></div></div><div class="card-action article-tags"><a href="/tags/flask/"><span class="chip bg-color">flask</span> </a><a href="/tags/redis/"><span class="chip bg-color">redis</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/34409.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//medias/featureimages/11.jpg" class="responsive-img" alt="置顶! 如何阅读本站"> <span class="card-title">置顶! 如何阅读本站</span></div></a><div class="card-content article-content"><div class="summary block-with-text">文章集合</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2020-09-27 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E6%9C%AC%E7%AB%99%E6%96%87%E7%AB%A0%E9%9B%86%E5%90%88/" class="post-category">本站文章集合</a></span></div></div><div class="card-action article-tags"><a href="/tags/Flask/"><span class="chip bg-color">Flask</span> </a><a href="/tags/Python/"><span class="chip bg-color">Python</span> </a><a href="/tags/Memcache/"><span class="chip bg-color">Memcache</span></a></div></div></div></div></article></div><script>$("#articleContent").on("copy",function(e){var n,t,o,i;void 0===window.getSelection||(""+(n=window.getSelection())).length<Number.parseInt("120")||(t=document.getElementsByTagName("body")[0],(o=document.createElement("div")).style.position="absolute",o.style.left="-99999px",t.appendChild(o),o.appendChild(n.getRangeAt(0).cloneContents()),"PRE"===n.getRangeAt(0).commonAncestorContainer.nodeName&&(o.innerHTML="<pre>"+o.innerHTML+"</pre>"),i=document.location.href,o.innerHTML+='<br />来源: 文彦笔记<br />文章作者: 文彦<br />文章链接: <a href="'+i+'">'+i+"</a><br />本文章著作权归作者所有，任何形式的转载都请注明出处。",n.selectAllChildren(o),window.setTimeout(function(){t.removeChild(o)},200))})</script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/codeBlock/codeShrink.js"></script><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h1,  h2, h3, h4, h5, h6"});let t=0,e="toc-heading-",n=($("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h1,  h2, h3, h4, h5, h6").each(function(){$(this).attr("id",e+ ++t)}),parseInt(.4*$(window).height()-64)),o=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>n?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});const i="expanded";let a=$("#toc-aside"),c=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){a.hasClass(i)?(a.removeClass(i).hide(),c.removeClass("l9")):(a.addClass(i).show(),c.addClass("l9"));var e="artDetail";if(0!==(e=$("#artDetail")).length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#prenext-posts").width(t)}})})</script></main><footer class="page-footer bg-color"><script data-ad-client="ca-pub-4337512190549598" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2019</span> <a href="/about" target="_blank">文彦 </a>|&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp; <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br><span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/ningwenyan" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:ningyanke@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fas fa-rss"></i></a></div></div></footer><div class="progress-bar"></div><script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"})</script><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//js/search.js"></script><script type="text/javascript">$(function(){searchFunc("https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-arrow-up"></i></a></div><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/materialize/materialize.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/masonry/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/aos/aos.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/scrollprogress/scrollProgress.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//js/matery.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?407f502eb914179baa7e4efa6da65a6e",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)}()</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)}()</script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/others/clicklove.js" async></script><script async src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/others/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/gh/ningwenyan/ningwenyan.github.io@master//libs/instantpage/instantpage.js" type="module"></script><script type="text/javascript" color="122 103 238" opacity="0.7" zindex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"https://cdn.jsdelivr.net/npm/live2d-widget-model-shizuku@1.0.5/assets/shizuku.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0},react:{opacity:.7}})</script></body></html>